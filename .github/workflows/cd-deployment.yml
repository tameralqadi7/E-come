name: Continuous Deployment (Render)

on:
  workflow_run:
    workflows: ["PHP Project CI"] # الانتظار حتى ينجح فحص الكود والدوكر
    types:
      - completed

jobs:
  deploy-to-render:
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'success' }} # شرط نجاح الـ CI أولاً

    steps:
      - name: Checkout Code
        uses: actions/checkout@v3

      - name: Trigger Render Deployment
        run: |
          echo "CI passed successfully. Notifying Render to pull latest Docker changes..."
          echo "Target Platform: Render.com"
          echo "Deployment Strategy: Docker Runtime"
          # في Render، بمجرد وصول الكود للـ Main، المنصة تبدأ البناء تلقائياً.
          # هذا السطر للتأكيد في سجلات GitHub Actions
          echo "Deployment triggered for: https://e-come-qvs1.onrender.com"